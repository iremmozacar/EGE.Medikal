@model List<EgeApp.Frontend.Mvc.Models.Category.CategoryViewModel>
@{
    ViewData["PageHeader"] = "Kategori Anasayfa";
    ViewData["ShowButton"] = true;
    ViewData["ButtonTitle"] = "Kategori Ekle";
    ViewData["ButtonLink"] = "/admin/category/create";
}

<div class="card">
    <div class="card-body">
        <table id="my-data-table" class="table table-bordered table-striped">
            <thead>
                <tr>
                    <th width="70">Id</th>
                    <th>Kategori Adı</th>
                    <th width="100">Durum</th>
                    <th width="80">İşlemler</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var category in Model)
                {
                    <tr>
                        <td>@category.Id</td>
                        <td>@category.Name</td>
                        <td>
                            <div class="form-group">
                                <div class="custom-control custom-switch">
                                    <input asp-for="@category.IsActive" type="checkbox" class="custom-control-input"
                                        id="isActive-@category.Id" onchange="changeCategoryStatus('@category.Id')">
                                    <label class="custom-control-label" for="isActive-@category.Id"></label>
                                </div>
                            </div>
                        </td>
                        <td>
                            <a asp-area="Admin" asp-controller="Category" asp-action="Edit" asp-route-id="@category.Id"
                                class="btn btn-warning btn-sm">Detay</a>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
    <!-- /.card-body -->
</div>

@section Scripts {
    <!-- DataTables  & Plugins -->
    <script src="~/admin/plugins/datatables/jquery.dataTables.min.js"></script>
    <script src="~/admin/plugins/datatables-bs4/js/dataTables.bootstrap4.min.js"></script>
    <script src="~/admin/plugins/datatables-responsive/js/dataTables.responsive.min.js"></script>
    <script src="~/admin/plugins/datatables-responsive/js/responsive.bootstrap4.min.js"></script>
    <script src="~/admin/plugins/datatables-buttons/js/dataTables.buttons.min.js"></script>
    <script src="~/admin/plugins/datatables-buttons/js/buttons.bootstrap4.min.js"></script>
    <script src="~/admin/plugins/jszip/jszip.min.js"></script>
    <script src="~/admin/plugins/pdfmake/pdfmake.min.js"></script>
    <script src="~/admin/plugins/pdfmake/vfs_fonts.js"></script>
    <script src="~/admin/plugins/datatables-buttons/js/buttons.html5.min.js"></script>
    <script src="~/admin/plugins/datatables-buttons/js/buttons.print.min.js"></script>
    <script src="~/admin/plugins/datatables-buttons/js/buttons.colVis.min.js"></script>
    @await Html.PartialAsync("_DataTablesPartial")
    <script>
        const changeCategoryStatus = function (categoryId) {
            $.ajax({
                url: `/admin/category/updateisactive/${categoryId}`,
                type: 'GET',
                success: function (res) {
                    var isActiveCheckbox = document.getElementById("isActive-" + categoryId);
                    // Durum değiştiğinde başka işlemler yapılabilir
                },
                error: function (err) {
                    console.log(err);
                }
            });
        }
    </script>
}